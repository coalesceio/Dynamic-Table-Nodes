fileVersion: 1
id: c9368c62-2862-47e3-a55c-daf9f96ed553
name: DT_DIM_PRODUCT_INVENTORY
operation:
  config:
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    cpygrants: false
    downstreamOption: true
    initialize: ON_CREATE
    lagSpecification:
      items:
        - lagPeriod: Minutes
          lagValue: 60
    orderBy:
      items:
        - colName:
            columnCounter: 3049b9b4-73ea-41a3-8f65-0197edd62cfa
            stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
    orderByDateTime:
      items:
        - {}
    orderseq:
      items:
        - {}
    partitionBy:
      items:
        - partColName:
            columnCounter: cd3c080d-ef22-4bcc-9d5e-9b207f2a7754
            stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
    recordVersioning: Datetime Column
    recordorderBy:
      items:
        - {}
    refresh_mode: AUTO
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: dynamic table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ebfc8661-e00b-4ad5-9389-032eca87c237
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_PRODUCT_INVENTORY_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd3c080d-ef22-4bcc-9d5e-9b207f2a7754
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRODUCT_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af3d6a88-d706-48e4-897c-b09febfa9207
                stepCounter: a744dc34-66cc-42da-a24e-254683a0e576
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ac8ecb5-4574-41f0-a233-bad63040f81a
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: PRODUCT_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc97f4b4-2027-4df9-b066-62f39dccee52
                stepCounter: a744dc34-66cc-42da-a24e-254683a0e576
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3049b9b4-73ea-41a3-8f65-0197edd62cfa
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: LAST_UPDATED_TS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6155b859-f5b4-4d4b-a266-a9a5267460d0
                stepCounter: a744dc34-66cc-42da-a24e-254683a0e576
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 46c1a832-0a3e-4ec4-8e26-a45a362c0389
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a011e232-ef7f-4337-b97e-2d00f6cb7056
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 63dfb415-cdfa-41a7-b7bb-239f93055266
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ac3fafd1-443b-421a-a60d-3071c16b5292
          stepCounter: c9368c62-2862-47e3-a55c-daf9f96ed553
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          PRODUCT_INVENTORY: a744dc34-66cc-42da-a24e-254683a0e576
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_DATA
            nodeName: PRODUCT_INVENTORY
        join:
          joinCondition: FROM {{ ref('SOURCE_DATA', 'PRODUCT_INVENTORY') }} "PRODUCT_INVENTORY"
        name: DT_DIM_PRODUCT_INVENTORY
        noLinkRefs: []
  name: DT_DIM_PRODUCT_INVENTORY
  overrideSQL: false
  schema: ""
  sqlType: "350"
  type: sql
  version: 1
type: Node
