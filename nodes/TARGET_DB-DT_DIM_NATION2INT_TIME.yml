fileVersion: 1
id: 94432f8a-e48e-4b5a-af0c-246d4f77c081
name: DT_DIM_NATION2INT_TIME
operation:
  config:
    baseLocation: ""
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    cpygrants: false
    downstreamOption: false
    externalVolume: ""
    initialize: ON_CREATE
    lagSpecification:
      items:
        - lagPeriod: Minutes
          lagValue: "6000"
    orderBy:
      items:
        - colName: null
    orderByDateTime:
      items:
        - {}
    orderseq:
      items:
        - colNameseq:
            columnCounter: 1636669c-a66e-4b52-91ab-8000bfae3847
            stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
    partitionBy:
      items:
        - partColName:
            columnCounter: 04ae76d6-1648-4721-831f-e41ad84209e1
            stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
    recordVersioning: Integer Column
    recordorderBy:
      items:
        - ocolName:
            columnCounter: c2db8fd5-90e1-409e-b8ca-85b22c1ffe3f
            stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
    refresh_mode: AUTO
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: dynamic table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a99e835c-4894-4727-bc8c-d98b62107088
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_NATION2_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04ae76d6-1648-4721-831f-e41ad84209e1
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: N_NATIONKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5bd4d13-c6bb-433f-9b83-5d5e83e75973
                stepCounter: c63a23da-1296-45a8-8efb-0156632e3133
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf4ba7ab-79eb-4b9c-9624-daca1abc923d
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: N_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76baaeb6-ed79-4725-9437-eafc860f64cc
                stepCounter: c63a23da-1296-45a8-8efb-0156632e3133
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1636669c-a66e-4b52-91ab-8000bfae3847
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: N_REGIONKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad4d3d2a-8fb4-4ed6-9f2f-7d2161d3c17c
                stepCounter: c63a23da-1296-45a8-8efb-0156632e3133
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ebf12f9-a962-4e99-a4c8-27ca17db90eb
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: VARCHAR(152)
        description: ""
        name: N_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d44265a3-0619-4bd6-a856-de8c4e649c8b
                stepCounter: c63a23da-1296-45a8-8efb-0156632e3133
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c2db8fd5-90e1-409e-b8ca-85b22c1ffe3f
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: STRING
        description: ""
        name: N_DATE_STRING
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 194831ba-10e9-45f2-b7f3-7f5511dbe7ca
                stepCounter: c63a23da-1296-45a8-8efb-0156632e3133
            transform: to_timestamp("STG_NATION"."N_DATE_STRING")
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3c15a64b-0926-464e-a100-ecbb86f52970
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7f07f724-a54f-4a44-a5ac-facad6238eaa
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: bd232d1d-6d77-4503-a693-603230cc8124
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b9e9e6bb-18aa-4021-b7c7-9ba20d5fa611
          stepCounter: 94432f8a-e48e-4b5a-af0c-246d4f77c081
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_NATION: c63a23da-1296-45a8-8efb-0156632e3133
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_DB
            nodeName: STG_NATION
        join:
          joinCondition: FROM {{ ref('TARGET_DB', 'STG_NATION') }} "STG_NATION"
        name: DT_DIM_NATION2INT_TIME
        noLinkRefs: []
  name: DT_DIM_NATION2INT_TIME
  overrideSQL: false
  schema: ""
  sqlType: "350"
  type: sql
  version: 1
type: Node
