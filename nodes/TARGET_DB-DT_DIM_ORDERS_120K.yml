fileVersion: 1
id: 297a751e-1795-42c2-a41c-7c8bb5842909
name: DT_DIM_ORDERS_120K
operation:
  config:
    downstreamOption: false
    initialize: ON_CREATE
    lagSpecification:
      items:
        - {}
    orderBy:
      items:
        - {}
    orderByDateTime:
      items:
        - {}
    partitionBy:
      items:
        - {}
    recordVersioning: Datetime Column
    refresh_mode: AUTO
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: Dynamic Table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a28fe8c1-b043-468c-8b02-6eb413ecf569
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_ORDERS_120K_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 86496df7-b303-4642-ba88-83f16a0a6955
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: O_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93bc5548-0af3-424b-ac42-4f53c99b45b0
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20220bef-16c1-45d3-8039-47ac4f82b2f0
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: O_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f530944-7e3c-4429-9f10-2154924eac8c
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24dacaa6-523c-4ca4-ac93-5fd00073b0fe
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: O_ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b082008e-a161-4c8a-9282-7d499ad9bdf7
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1b47ec4-405c-424c-82cf-b7c0361f2cc4
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: O_TOTALPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf470675-000c-4ff5-9d53-9f86eee291f5
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb7f334a-3ca1-43b0-8276-60b7648f1569
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: O_ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c590742-ab91-4654-8edf-a2a7cbad2c9a
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5b4fa3c7-5f61-4213-9ad7-61906ea33c2c
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: VARCHAR(15)
        description: ""
        hashDetails: null
        name: O_ORDERPRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ef18c92b-35f8-48cd-b2ee-2eaab03ffea6
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 18af15a1-3bc5-4e5a-8aeb-fa78c43d1d94
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: VARCHAR(15)
        description: ""
        hashDetails: null
        name: O_CLERK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b43165a-4a39-4d65-91f1-d9c0b0ffe201
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: de1a3fb9-2e2e-4111-bf05-c6a090c068c8
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: O_SHIPPRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 81c6a630-9e07-4d10-bbca-620d5d186c4a
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47af0fe9-b777-417b-9b39-0eae000551a2
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: VARCHAR(79)
        description: ""
        hashDetails: null
        name: O_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9fa69c7-2bdd-4a96-8566-19cbf09952e7
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 218e10ee-bc9e-4bbf-89ad-4dc24183f6af
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: TIMESTAMP_LTZ(9)
        description: ""
        hashDetails: null
        name: O_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e0b2100-0270-4232-abc9-1b229863b460
                stepCounter: 30e144d2-e8bf-4d7d-84c8-8f7e3de9a484
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 9fdfcda9-e978-4488-8494-88616fb201e3
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ order_by_col() }}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b30e546f-02e7-4aa4-924c-a118ae7d8351
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({{ order_by_col()}}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 61e872c9-45fa-4260-b57e-031e125ff38e
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({{ order_by_col()}}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4d4ae964-dce6-492c-b0bd-36f0acc9188f
          stepCounter: 297a751e-1795-42c2-a41c-7c8bb5842909
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({{ order_by_col()}}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_DB
            nodeName: DT_WRK_ORDERS_120K
        join:
          joinCondition: FROM {{ ref('TARGET_DB', 'DT_WRK_ORDERS_120K') }} "DT_WRK_ORDERS_120K"
        name: DT_DIM_ORDERS_120K
        noLinkRefs: []
  name: DT_DIM_ORDERS_120K
  overrideSQL: false
  schema: ""
  sqlType: "249"
  type: sql
  version: 1
type: Node
