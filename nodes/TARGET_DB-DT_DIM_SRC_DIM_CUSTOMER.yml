fileVersion: 1
id: f7d3a790-8e4d-42a3-b795-0908b7ede738
name: DT_DIM_SRC_DIM_CUSTOMER
operation:
  config:
    advanceWarehouse: false
    backfill: true
    backfillSource: DT_DIM_SRC_DIM_CUSTOMER_HIST
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    cpygrants: false
    downstreamOption: true
    immutabilityConstraint: true
    immutableExpression: LAST_UPDATED_TIMESTAMP < CURRENT_TIMESTAMP() - INTERVAL '7 days'
    initialize: ON_CREATE
    initializeWarehouseSize: Large
    lagSpecification:
      items:
        - lagPeriod: Minutes
          lagValue: "60"
    orderBy:
      items:
        - colName:
            columnCounter: e03b1ef6-1bd0-4954-a622-45dd4bf2709a
            stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
    orderByDateTime:
      items:
        - {}
    orderseq:
      items:
        - {}
    partitionBy:
      items:
        - partColName:
            columnCounter: 3dc4d8ab-4113-4d68-9adc-b8d05f76e208
            stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
    recordVersioning: Datetime Column
    recordorderBy:
      items:
        - {}
    refreshWarehouseSize: Small
    refresh_mode: AUTO
    timeTravel: true
    timeTravelreference: OFFSET
    timeTraveltype: BEFORE
    timeTravelvalue: "-180"
    warehouseName: COMPUTE_WH
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: dynamic table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f21df8b9-ce91-46dc-9770-4528df0bc10a
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_SRC_DIM_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09f023fc-bfa2-4cde-a2fa-25f0c7ed896b
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7cf0b0db-8c7c-491e-a585-362fc081ae07
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4383d6dc-ea83-4822-ad2f-9d64277e627f
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CUSTOMER_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66f70c41-9e67-4088-9fff-d3fe807c3c1b
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec7a3e51-1c3f-4a7f-b94e-2eb5d077c541
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: CUSTOMER_EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 52ea2e38-0c23-4d92-aa27-ee5795199040
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ebdd95f9-2acb-49c7-b6c1-34d15209cf4e
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: VARCHAR(16777216)
        description: ""
        name: RECORD_VERSION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5508345a-ee20-48d8-94f7-f42aa231539c
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3dc4d8ab-4113-4d68-9adc-b8d05f76e208
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: LAST_UPDATED_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 145532e1-5090-4551-bcc7-ecf14c92323d
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 420ec07f-0725-437f-b99f-d1c06507f7ee
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: RECORD_SEQUENCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 242919d9-8188-4e7b-ab0f-3fc7c6383c06
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e03b1ef6-1bd0-4954-a622-45dd4bf2709a
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: DATA_LOAD_TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a2e5dbb4-3412-4861-8afe-4b92675b4a8e
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4575e859-da1c-4187-8cb2-817c8932a129
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: DATE
        description: ""
        name: RECORD_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 092d7a6f-178e-46e3-a73e-b325393c2f25
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 816aa263-558d-420b-b165-85c9c3e3f98c
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: RECORD_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 312955c8-8406-40e1-a791-69c820858006
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b9ef6ec-7a3c-47b3-a6d9-4fca33238367
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: ACTIVE_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac0a8857-f1b4-4406-a079-9be42e4f1362
                stepCounter: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d9c241cd-c01b-4952-bb33-baaa593edfaa
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1a89a4b7-13c7-4f41-a26b-ef1ad23da81c
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ff789735-8f6f-4dc0-92ef-1ea4cc75c874
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 8915d5c1-a788-4dc7-b0a8-575136ed17b2
          stepCounter: f7d3a790-8e4d-42a3-b795-0908b7ede738
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DT_WRK_SRC_DIM_CUSTOMER: 0ede83d4-dff6-41d2-8a55-9846b3fe8361
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: TARGET_DB
            nodeName: DT_WRK_SRC_DIM_CUSTOMER
        join:
          joinCondition: FROM {{ ref('TARGET_DB', 'DT_WRK_SRC_DIM_CUSTOMER') }} "DT_WRK_SRC_DIM_CUSTOMER"
        name: DT_DIM_SRC_DIM_CUSTOMER
        noLinkRefs: []
  name: DT_DIM_SRC_DIM_CUSTOMER
  overrideSQL: false
  schema: ""
  sqlType: "350"
  type: sql
  version: 1
type: Node
