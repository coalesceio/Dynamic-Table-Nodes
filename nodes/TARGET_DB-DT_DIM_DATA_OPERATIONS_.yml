fileVersion: 1
id: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
name: DT_DIM_DATA_OPERATIONS_
operation:
  config:
    baseLocation: ""
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    cpygrants: false
    downstreamOption: false
    externalVolume: ""
    initialize: ON_CREATE
    lagSpecification:
      items:
        - lagPeriod: Minutes
          lagValue: "6000"
    orderBy:
      items:
        - colName:
            columnCounter: 27386d86-6cc0-4bb1-bbd9-f42bab59a13e
            stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
    orderByDateTime:
      items:
        - {}
    orderseq:
      items:
        - {}
    partitionBy:
      items:
        - partColName:
            columnCounter: 72c8d153-61d9-48d8-8eee-ed9953549c88
            stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
    recordVersioning: Datetime Column
    recordorderBy:
      items:
        - {}
    refresh_mode: AUTO
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: dynamic table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a1b182c6-727e-4e3e-b38c-c82e353af45e
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_DATA_OPERATIONS1_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 57029e52-e1d5-41ab-a8fa-6737a95a9d35
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: TIMESTAMP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc9ac501-a857-464f-80b3-cca2ac15b51b
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 72c8d153-61d9-48d8-8eee-ed9953549c88
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: RECORD_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4f7cfe5-ebd3-404f-8e68-fa503fda325d
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a5f4eaf-18af-4c43-b68d-47cadcd6508b
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: VARCHAR(255)
        description: ""
        name: NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ac7830c-8f52-49fc-bf4f-8c68ddfe9e28
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 024c7a55-03cf-4c1e-a214-abb1766fc53b
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: AGE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ab392cb9-dc3b-430c-a824-26e48966c956
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87d4922b-28bf-4d12-a026-bba798958393
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: VARCHAR(255)
        description: ""
        name: CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 18b672ed-4e5c-4a27-afe5-2c8a0d239bb9
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b32e2ce2-c7d0-4c8e-981f-c280b21f275d
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: OPERATION_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 017311bb-d1d3-458a-82b1-7d3d6a99144a
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2661cb65-df08-450c-b19b-965336f64903
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SOURCE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2641b8ea-425e-4fc1-b7ce-0a3c05de826e
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6f30faf8-0cdb-45a0-8822-6eb7a020392f
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: DML_IDENTIFIER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 41a736e1-19e0-45a1-ad42-7b287ff048dd
                stepCounter: 473eaca8-651f-49e2-82a3-0541558f2f19
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 86ef5d5e-ac44-4b6f-8fa1-6c7106fc3203
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6739c61b-f406-4c08-8923-a4f8949e920b
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6a6bb6f1-3099-4e8e-9a0b-7d0ac6bea8f8
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5bff9d5a-99ea-49b6-9705-d460be067893
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 27386d86-6cc0-4bb1-bbd9-f42bab59a13e
          stepCounter: 4ad2b5db-1b69-490e-8a32-3f0dfcdd389a
        config: {}
        dataType: ""
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: date_time
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CONVERT_TIMEZONE('UTC', 'EST',"DATA_OPERATIONS"."TIMESTAMP")
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DATA_OPERATIONS: 473eaca8-651f-49e2-82a3-0541558f2f19
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_DATA
            nodeName: DATA_OPERATIONS
        join:
          joinCondition: FROM {{ ref('SOURCE_DATA', 'DATA_OPERATIONS') }} "DATA_OPERATIONS"
        name: DT_DIM_DATA_OPERATIONS_
        noLinkRefs: []
  name: DT_DIM_DATA_OPERATIONS_
  overrideSQL: false
  schema: ""
  sqlType: "350"
  type: sql
  version: 1
type: Node
