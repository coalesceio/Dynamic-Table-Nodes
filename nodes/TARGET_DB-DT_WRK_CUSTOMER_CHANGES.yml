fileVersion: 1
id: e6f53ba3-0101-4485-9950-9107823789fa
name: DT_WRK_CUSTOMER_CHANGES
operation:
  config:
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    downstreamOption: false
    initialize: ON_CREATE
    lagSpecification:
      items:
        - lagPeriod: Minutes
          lagValue: 60
    orderBy:
      items:
        - {}
    orderByDateTime:
      items:
        - {}
    partitionBy:
      items:
        - partColName:
            columnCounter: e4a08c1c-25dc-41f6-a411-7aa798e70d01
            stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        - partColName:
            columnCounter: c408667c-d260-4f81-8904-6b7c525d3ce0
            stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
    recordVersioning: Date Column and Time Column
    refresh_mode: AUTO
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: dynamic table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e4a08c1c-25dc-41f6-a411-7aa798e70d01
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: CUSTOMER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30163e83-f94b-416b-b89f-25834d40fa5d
                stepCounter: 1bfcb34a-651c-4dfa-9bfa-6dd2f77f982c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6271a5ff-aa90-440b-b7a4-4e5b079173b8
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: FIRST_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 57bfedc9-442f-4f92-a628-d84f0723489b
                stepCounter: 1bfcb34a-651c-4dfa-9bfa-6dd2f77f982c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a5615d1-44ea-427b-a47c-c8c383738f57
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: LAST_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4754ce87-1534-403d-883e-a403f691cdd2
                stepCounter: 1bfcb34a-651c-4dfa-9bfa-6dd2f77f982c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c408667c-d260-4f81-8904-6b7c525d3ce0
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: EMAIL
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 013a67f6-4a2e-4af2-9a37-25e6f0a96c43
                stepCounter: 1bfcb34a-651c-4dfa-9bfa-6dd2f77f982c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bb5d84e5-098b-4a5b-98c4-9a928f7aff71
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: PHONE_NUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb7348b5-894b-4cb8-b9b8-5bf4bc07fc19
                stepCounter: 1bfcb34a-651c-4dfa-9bfa-6dd2f77f982c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dc13c51-7e5a-4d3a-8ca0-eeed5198eada
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: VARCHAR(365)
        description: ""
        name: FULL_ADDRESS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5b0d568b-b021-4611-9ad5-98d9275f3066
                stepCounter: 1bfcb34a-651c-4dfa-9bfa-6dd2f77f982c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dc415463-692c-49fe-b6e1-86a376ef92c2
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: UPDATE_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b16c21fe-410d-4a1e-af53-a976e62e9604
                stepCounter: 1bfcb34a-651c-4dfa-9bfa-6dd2f77f982c
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5f5a1609-e79f-40ef-8ba9-3c7fc03066d1
          stepCounter: e6f53ba3-0101-4485-9950-9107823789fa
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({{ order_by_col()}}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_DATA
            nodeName: CUSTOMER_CHANGES
        join:
          joinCondition: FROM {{ ref('SOURCE_DATA', 'CUSTOMER_CHANGES') }} "CUSTOMER_CHANGES"
        name: DT_WRK_CUSTOMER_CHANGES
        noLinkRefs: []
  name: DT_WRK_CUSTOMER_CHANGES
  overrideSQL: false
  schema: ""
  sqlType: "260"
  type: sql
  version: 1
type: Node
