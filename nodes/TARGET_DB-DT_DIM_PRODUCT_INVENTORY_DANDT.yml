fileVersion: 1
id: 90de4fbe-2168-43d0-a24e-8768969e90f0
name: DT_DIM_PRODUCT_INVENTORY_DANDT
operation:
  config:
    clusterKey: false
    clusterKeyConfig:
      items:
        - {}
    clusterKeyConfigExpressions:
      items:
        - {}
    clusterKeyExpressions: false
    cpygrants: false
    downstreamOption: false
    initialize: ON_CREATE
    lagSpecification:
      items:
        - lagPeriod: Minutes
          lagValue: 60
    orderBy:
      items:
        - colName: null
    orderByDateTime:
      items:
        - colNameDate:
            columnCounter: 7168deb3-c6e0-44ee-bfd4-f6016a4186ba
            stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
          colNameTimestamp:
            columnCounter: ecaddeff-daf4-4197-acbf-03fa1d751cd8
            stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
    orderseq:
      items:
        - {}
    partitionBy:
      items:
        - partColName:
            columnCounter: e9bda9bc-7b70-4407-9c67-80944874520a
            stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
    recordVersioning: Date Column and Time Column
    recordorderBy:
      items:
        - {}
    refresh_mode: AUTO
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: TARGET_DB
  materializationType: dynamic table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0fddb5e9-a846-400c-b09b-c905a6038172
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_PRODUCT_INVENTORY_DANDT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9bda9bc-7b70-4407-9c67-80944874520a
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRODUCT_ID
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69a8f0a7-9453-4478-9e70-88bf6becce4c
                stepCounter: 18954115-ae5d-4b8f-befc-15de5dc212e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5c80df5-6ca7-4473-8fe3-95d84cf8404e
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: PRODUCT_NAME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bab19c93-8e8e-4993-8881-bfde4d7468c9
                stepCounter: 18954115-ae5d-4b8f-befc-15de5dc212e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7168deb3-c6e0-44ee-bfd4-f6016a4186ba
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: DATE
        description: ""
        name: LAST_UPDATED_DATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f7b17e8d-d0cd-498f-937a-eb3fe14f5b4f
                stepCounter: 18954115-ae5d-4b8f-befc-15de5dc212e2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecaddeff-daf4-4197-acbf-03fa1d751cd8
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: TIME(9)
        description: ""
        name: LAST_UPDATED_TIME
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8157f46-3a5a-4917-b0b1-7dd2fc86291e
                stepCounter: 18954115-ae5d-4b8f-befc-15de5dc212e2
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 55b8362a-d8a8-4a37-8938-26dd7dce6437
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 50a55628-3065-4ba4-8195-6a59f1649c77
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 087946be-abcd-4797-9f43-0e7a39a38b57
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%}{{order_by_col_int()}} {%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 558e7577-c532-49e3-9d83-559070f9bf93
          stepCounter: 90de4fbe-2168-43d0-a24e-8768969e90f0
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({%if config.recordVersioning not in ('Integer Column')%}{{order_by_col()}}{%else%} {{order_by_col_int()}}{%endif%}) OVER (PARTITION BY {{ partition_by() }} ORDER BY {{ order_by_col() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          PRODUCT_INVENTORY_DANDT: 18954115-ae5d-4b8f-befc-15de5dc212e2
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: SOURCE_DATA
            nodeName: PRODUCT_INVENTORY_DANDT
        join:
          joinCondition: FROM {{ ref('SOURCE_DATA', 'PRODUCT_INVENTORY_DANDT') }} "PRODUCT_INVENTORY_DANDT"
        name: DT_DIM_PRODUCT_INVENTORY_DANDT
        noLinkRefs: []
  name: DT_DIM_PRODUCT_INVENTORY_DANDT
  overrideSQL: false
  schema: ""
  sqlType: "350"
  type: sql
  version: 1
type: Node
